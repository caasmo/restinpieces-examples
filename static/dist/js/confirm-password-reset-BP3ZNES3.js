import{c}from"./chunk-NTKSLLJF.js";var a=class{constructor(){this.rp=new c({baseURL:"http://localhost:8080"}),this.form=document.getElementById("confirmResetForm"),this.messageDiv=document.getElementById("message"),this.form.addEventListener("submit",this.handleSubmit.bind(this))}validateForm(s,t){if(s!==t)throw new Error("Passwords do not match");if(s.length<8)throw new Error("Password must be at least 8 characters")}showMessage(s,t=!1){this.messageDiv.textContent=s,this.messageDiv.className=t?"message error":"message success"}createSuccessUI(){let s=document.createElement("div");s.className="success-message",s.innerHTML="<h3>Password reset successful!</h3>";let t=document.createElement("button");t.textContent="Log In",t.onclick=()=>window.location.href="/login.html",this.form.remove(),this.messageDiv.textContent="",this.messageDiv.appendChild(s),this.messageDiv.appendChild(t)}handleSubmit(s){s.preventDefault();let o=new URLSearchParams(window.location.search).get("token"),r=document.getElementById("password").value,i=document.getElementById("confirmPassword").value;this.messageDiv.textContent="",this.messageDiv.classList.remove("error","success");try{if(this.validateForm(r,i),!o)throw new Error("Invalid password reset token");this.showMessage("Resetting password..."),this.rp.request("confirm_password_reset",{},{token:o,password:r,password_confirm:i}).then(e=>{if((e==null?void 0:e.status)===200&&(e!=null&&e.message))this.showMessage("Password reset successful!"),this.createSuccessUI();else throw new Error((e==null?void 0:e.message)||"Invalid response from server")}).catch(e=>{var n;console.error("Password reset failed:",e),this.showMessage(e.response?((n=e.response.data)==null?void 0:n.message)||"Password reset failed":e.message,!0)})}catch(e){console.error("Validation failed:",e),this.showMessage(e.message,!0)}}};document.addEventListener("DOMContentLoaded",()=>new a);
