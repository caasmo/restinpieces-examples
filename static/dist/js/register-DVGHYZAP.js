import{c}from"./chunk-NTKSLLJF.js";var o=class{constructor(){this.rp=new c({baseURL:"http://localhost:8080"}),this.form=document.getElementById("registerForm"),this.messageDiv=document.getElementById("message"),this.form.addEventListener("submit",this.handleSubmit.bind(this))}validateForm(a,e,t){if(e!==t)throw new Error("Passwords do not match");if(e.length<8)throw new Error("Password must be at least 8 characters");return{email:a,password:e,confirmPassword:t}}showMessage(a,e=!1){this.messageDiv.textContent=a,this.messageDiv.className=e?"message error":"message success"}createSuccessUI(a){let e=document.createElement("div");e.className="user-info",e.innerHTML=`
      <h3>Registration Successful!</h3>
      <pre>${JSON.stringify(a,null,2)}</pre>
    `;let t=document.createElement("div");if(t.className="button-container",!a.verified){let i=document.createElement("button");i.textContent="Verify Email",i.onclick=()=>window.location.href="/verify-email",t.appendChild(i)}let n=document.createElement("button");n.textContent="Go to Dashboard",n.onclick=()=>window.location.href="dashboard.html",t.appendChild(n),this.form.remove(),this.messageDiv.textContent="",this.messageDiv.appendChild(e),this.messageDiv.appendChild(t)}handleSubmit(a){a.preventDefault();let e=document.getElementById("email").value,t=document.getElementById("password").value,n=document.getElementById("confirmPassword").value;this.messageDiv.textContent="",this.messageDiv.classList.remove("error","success");try{let{email:i,password:m}=this.validateForm(e,t,n);this.showMessage("Registering..."),this.rp.registerWithPassword({identity:i,password:m,password_confirm:n}).then(s=>{var r,d;if((r=s.data)!=null&&r.access_token&&((d=s.data)!=null&&d.record))this.rp.store.auth.save(s.data),this.showMessage("Registration successful!"),this.createSuccessUI(s.data.record);else throw new Error("Invalid registration response")}).catch(s=>{console.error("Registration failed:",s),this.showMessage(s.response?JSON.stringify(s.response,null,2):s.message,!0)})}catch(i){console.error("Validation failed:",i),this.showMessage(i.message,!0)}}};document.addEventListener("DOMContentLoaded",()=>new o);
